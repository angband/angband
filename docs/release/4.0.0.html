<!DOCTYPE html>
<title>Angband Releases: 4.0.0 - rephial.org</title>
<meta charset="utf-8">

<link href='https://fonts.googleapis.com/css?family=Libre+Baskerville:700,400|Open+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/angband/css/style.css" type="text/css">
<link rel="shortcut icon" href="/angband/img/favicon.png" type="image/png">
<meta name="viewport" content="width=device-width">

<body >

<header>
	<div class="container">
		<h1><a href="/angband/"><img src='/angband/img/header.png' alt="Angband"></a></h1>
		<nav>
			<a href="/angband/develop" >About</a>
			<a href="/release/angband/" class='selected'>Releases</a>
			<a href="https://angband.readthedocs.io/">Docs</a>
			<a href="http://angband.oook.cz/forum/">Forum</a>
		</nav>
	</div>
</header>

<div id="content">
	<div class="container">
		<h2>Angband Releases: 4.0.0</h2>

<div id="releasesnav" class="highlight_box">
<h3>Other releases:</h3>
<ul><li><a href='4.2.1'>4.2.1</a><li><a href='4.2.0'>4.2.0</a><li><a href='4.1.3'>4.1.3</a><li><a href='4.1.2'>4.1.2</a><li><a href='4.1.1'>4.1.1</a><li><a href='4.1.0'>4.1.0</a><li><a href='4.0.5'>4.0.5</a><li><a href='4.0.4'>4.0.4</a><li><a href='4.0.3'>4.0.3</a><li><a href='4.0.2'>4.0.2</a><li><a href='4.0.1'>4.0.1</a><li>4.0.0<li><a href='3.5.1'>3.5.1</a><li><a href='3.5.0'>3.5.0</a><li><a href='3.4.1'>3.4.1</a><li><a href='3.4.0'>3.4.0</a><li><a href='3.3.2'>3.3.2</a><li><a href='3.3.1'>3.3.1</a><li><a href='3.3.0'>3.3.0</a><li><a href='3.2.0'>3.2.0</a><li><a href='3.1.2v2'>3.1.2v2</a><li><a href='3.1.2'>3.1.2</a><li><a href='3.1.1'>3.1.1</a><li><a href='3.1.0beta'>3.1.0beta</a><li><a href='3.0.9b'>3.0.9b</a><li><a href='3.0.9a'>3.0.9a</a><li><a href='3.0.9'>3.0.9</a><li><a href='3.0.8'>3.0.8</a><li><a href='3.0.7s'>3.0.7s</a><li><a href='3.0.6'>3.0.6</a><li><a href='3.0.5'>3.0.5</a><li><a href='3.0.4'>3.0.4</a><li><a href='3.0.3'>3.0.3</a><li><a href='3.0.2'>3.0.2</a><li><a href='3.0.1'>3.0.1</a><li><a href='3.0.0'>3.0.0</a><li><a href='2.9.3'>2.9.3</a><li><a href='2.9.2'>2.9.2</a><li><a href='2.9.1'>2.9.1</a><li><a href='2.9.0'>2.9.0</a><li><a href='2.8.3'>2.8.3</a><li><a href='2.8.2'>2.8.2</a><li><a href='2.8.1'>2.8.1</a><li><a href='2.8.0'>2.8.0</a><li><a href='2.7.9v6'>2.7.9v6</a><li><a href='2.7.9v5'>2.7.9v5</a><li><a href='2.7.9v4'>2.7.9v4</a><li><a href='2.7.9v3'>2.7.9v3</a><li><a href='2.7.9v2'>2.7.9v2</a><li><a href='2.7.9v1'>2.7.9v1</a><li><a href='2.7.8'>2.7.8</a><li><a href='2.7.7'>2.7.7</a><li><a href='2.7.6'>2.7.6</a><li><a href='2.7.5'>2.7.5</a><li><a href='2.7.4'>2.7.4</a><li><a href='2.7.3'>2.7.3</a><li><a href='2.7.2'>2.7.2</a><li><a href='2.7.1'>2.7.1</a><li><a href='2.7.0'>2.7.0</a><li><a href='2.6.2'>2.6.2</a><li><a href='2.6.1'>2.6.1</a><li><a href='2.6.0'>2.6.0</a><li><a href='2.5.9'>2.5.9</a><li><a href='2.5.8'>2.5.8</a><li><a href='2.5.7'>2.5.7</a><li><a href='2.5.6'>2.5.6</a><li><a href='pcangband-1.4'>PCAngband 1.4</a><li><a href='2.5.5'>2.5.5</a><li><a href='2.5.4'>2.5.4</a><li><a href='2.5.3'>2.5.3</a><li><a href='2.5.2'>2.5.2</a><li><a href='2.5.1'>2.5.1</a><li><a href='2.5.0-beta'>2.5.0-beta</a><li><a href='pcangband-1.3'>PCAngband 1.3</a><li><a href='pcangband-1.2'>PCAngband 1.2</a><li><a href='2.4.fk'>2.4.frog-knows</a></ul>
</div>

<div class='page'>
<h3>Downloads</h3>

<ul>
<li><a href="http://rephial.org/downloads/4.0/angband-4.0.0.tar.gz" title="Source tarball, 20M">Source code</a></li>
<li><a href="http://rephial.org/downloads/4.0/angband-4.0.0-win.zip" title="Windows port, 19M zip file">Windows</a></li>
<li><a href="http://rephial.org/downloads/4.0/Angband-4.0.0-osx.dmg" title="Max OS X port, 19M .dmg file">OS X</a> (10.5+)</li>
</ul>

<h3>Background</h3>

<p>Soon before the release of 3.5.0, a community discussion had led to Nick McConnell becoming maintainer, with the intent of co-ordinating a major rewrite of the codebase and a mantra of "no gameplay changes until after the restructure".  After a lengthy period of beta-testing, Angband 4.0.0 was released on Monday 29 June 2015.</p>

<h3>Summary of Changes</h3>

<h4>Core-UI split</h4>

<ul>
<li>split the game into core and UI, and stop anything in the core from depending on anything in the UI</li>
</ul>

<h4>Modifiability</h4>

<ul>
<li>put many of the game constants in a text file rather than being compiled in, so they are user alterable</li>
<li>text data files cleaned up and documented</li>
<li>help file for modifying added - lib/help/modifying.txt</li>
</ul>

<h4>Dungeon generation</h4>

<ul>
<li>allow saving of dungeon levels and the town</li>
<li>allow generation of dungeon levels piece by piece</li>
<li>generalise level generation algorithms</li>
<li>allow more control over monster generation for thematic purposes</li>
<li>allow regions where restrictions apply (eg no ESP or no mapping)</li>
<li>there is a 'squares' array containing the terrain, locality info, traps, objects, flow info and monster on each grid</li>
</ul>

<h4>Player knowledge</h4>

<ul>
<li>duplicate the dungeon level "cave" struct, so that there is a reality version and a player version</li>
</ul>

<h4>Objects</h4>

<ul>
<li>replace pvals (aside from fuel, food etc) by an array of values</li>
<li>separate resistances, immunities etc from flags to allow for more values of resistance</li>
<li>separate brands and slays from flags to allow more variablilty</li>
<li>remove hard-coding of object tvals and svals, so objects can be safely added and moved around in object.txt</li>
<li>handle special artifacts straight from artifact.txt, so an unrecognised object kind (like Phial) automatically has a new object kind defined for it</li>
<li>put artifact activations in a text file</li>
<li>put objects in linked lists tied to the grid, store, monster or player that holds them, rather than indexed in a level-wide list</li>
</ul>

<h4>Inventory, quiver, equipment</h4>

<ul>
<li>make ordering of the inventory and quiver a UI construct only</li>
<li>use a Poschengband-style equipment template to specify equipment slots (so there is a standard player body, but more could be added)</li>
</ul>

<h4>Monster memory</h4>

<ul>
<li>make this a separate file, with full memory obtainable by copying monster.txt</li>
</ul>

<h4>Terrain/traps</h4>

<ul>
<li>multiple gameplay-identical terrain types now handled by temporary flags during generation</li>
<li>a full terrain flag system to allow easier addition/removal of terrain types</li>
<li>make traps separate entities, not terrain</li>
<li>make locked/jammed doors just closed doors with a trap</li>
<li>remove code reliance on the numerical value of terrain types</li>
</ul>

<h4>Squelch->Ignoring</h4>

<ul>
<li>remove all references to 'squelch', replace with 'ignore'</li>
<li>add ignore by ego type</li>
<li>emphasise the philosophy that the items are still there, just ignored</li>
</ul>

<h4>ID</h4>

<ul>
<li>have a separate field for every learnable property of an item</li>
<li>remove the IDENT_* flags</li>
</ul>

<h4>Effects</h4>

<ul>
<li>have all effects performed by a single function, and definable from text files</li>
</ul>

<h4>Monster attacks</h4>

<ul>
<li>put elemental spell effects back in the projection code rather than the spellcasting code</li>
<li>put blow effects into seprate handler functions</li>
</ul>

<h4>Player spells</h4>

<ul>
<li>generalise to make it easier to introduce new realms, classes, etc</li>
<li>have all spell info defined by a text data file</li>
</ul>

<h4>Projection</h4>

<ul>
<li>have separate functions to handle effects on terrain, objects, player, monsters</li>
<li>clarify different types of projection</li>
<li>allow for cone-shaped breaths</li>
<li>allow for a wider variety of effects (eg player/monsters pushed by force)</li>
</ul>

<h4>Stats, power, etc</h4>

<ul>
<li>refine and generalise stats where possible</li>
<li>attempt to clarify all the (frankly) fudge factors so they can more easily be seen and adjusted</li>
</ul>

<h4>General code stuff</h4>

<ul>
<li>rename files to be more sensible, or create new ones where needed</li>
<li>update debug commands to reflect the current game</li>
<li>move data into list-*.h files or edit files where appropriate</li>
<li>remove archaic stuff</li>
<li>document!</li>
</ul>

</div>

<script src="/js/releases.js"></script>
	</div>
</div>

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-10039059-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
